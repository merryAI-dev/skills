---
name: ppt-generator
description: PPT 자동 생성 스킬. 자연어 입력을 받아 PPT를 생성합니다. "PPT 만들어줘", "프레젠테이션 생성", "슬라이드 만들기" 등의 요청에 응답합니다.
allowed-tools: Bash(python3:*), Read, Write, AskUserQuestion
---

# PPT 자동 생성 스킬

자연어 입력을 받아 Claude API를 통해 PPT를 자동 생성하는 스킬입니다.

## 워크플로우

### Phase 1: 입력 수집

사용자에게 다음 정보를 요청합니다:

```
PPT 자동 생성을 도와드릴게요!

다음 정보를 알려주세요:

1. **콘텐츠 설명**: (자연어로 프레젠테이션 내용 설명)
   예: "H-온드림 2026년 제안서
   - 섹션 1: 발견 (예비 창업팀 발굴)
   - 섹션 2: 채용 (Born-AI 해커톤)
   - 섹션 3: 집중 (액셀러레이팅)"

2. **출력 파일명**: (기본: output.pptx)

3. **템플릿 파일**: (기본: tem.pptx)
```

### Phase 2: 환경 검증

```
ANTHROPIC_API_KEY 환경변수를 확인합니다.
- 설정됨: ✓ 진행
- 미설정: ✗ 사용자에게 설정 방법 안내
```

### Phase 3: 생성 실행

```bash
python pipeline.py '사용자 입력 콘텐츠' output.pptx
```

실행 중 표시:
- 콘텐츠 분석 중...
- Claude API 호출 중...
- 슬라이드 N개 생성 완료
- PPTX 파일 생성 중...

### Phase 4: 결과 요약

생성된 슬라이드 요약을 표시합니다:

```
=== 생성 완료 ===

총 슬라이드: 10개

[슬라이드 1]
- Chapter:
- Title: H-온드림 2026년 제안서
- Subtitle: 임팩트 스타트업 발굴 육성
- Lead: MYSC와 함께하는 창업 생태계 혁신 프로그램

[슬라이드 2]
- Chapter: 01. 발견
- Title: 예비 창업팀 발굴
- Subtitle:
- Lead: 대학생 중심 아이디어 발굴 및 팀 빌딩 지원

...

===

✓ PPTX 파일 생성 완료: /Users/.../output.pptx
```

### Phase 5: 글자수 검증

각 슬라이드의 글자수 제한 준수 여부를 체크합니다:

```
글자수 제한 검증:

✓ Chapter: 최대 5자 (번호 제외)
✓ Title: 10-20자 범위
✓ Subtitle: 15-30자 범위 (또는 빈 문자열)
✓ Lead: 25-35자 범위, 줄바꿈 없음

⚠️ 초과 슬라이드:
- 슬라이드 5: Lead 38자 (권장: 25-35자)
```

### Phase 6: 후속 작업 안내

```
생성이 완료되었습니다!

다음 작업을 추천합니다:
1. "PPT 검사해줘: output.pptx" - 품질 검사 실행
2. "리드문 넣어줘: output.pptx" - 리드문이 누락된 경우
```

---

## 글자수 제한 (중요!)

pipeline.py는 다음 글자수 제한을 적용합니다:

| 필드 | 제한 | 예시 |
|------|------|------|
| chapter | **최대 5자** (번호 제외) | "발견", "채용", "집중" |
| title | **10-20자** | "예비 창업팀 발굴" |
| subtitle | **15-30자** (없으면 빈 문자열) | "대학생 중심 아이디어 육성" |
| lead | **25-35자**, 줄바꿈 금지 | "MYSC와 함께하는 창업 생태계 혁신" |

---

## 콘텐츠 보존 원칙

Claude API는 다음 원칙에 따라 콘텐츠를 변환합니다:

1. **키워드 보존**: 사용자가 제공한 핵심 용어와 표현을 그대로 유지
2. **구조 파악**: [대괄호], 번호, 기호로 섹션과 계층 구분
3. **자연 분할**: 내용이 많으면 자연스럽게 여러 슬라이드로 분리
4. **제한 준수**: 글자수 제한 내에서 최대한 원본 의미 보존

---

## 참조 데이터

생성 품질 향상을 위해 `learning_data/patterns.json` 파일의 예시를 참조합니다:

- **문서 유형**: 제안서, 결과보고서, 기획안, 백서
- **스타일 패턴**: Chapter 형식, Title 평균 길이, Lead 평균 길이
- **섹션 예시**: 각 유형별 대표적인 섹션명과 구조

---

## 지원 문서 유형

- **제안서**: 사업 개요, 추진 계획, 기대 효과
- **결과보고서**: 추진 경과, 성과, 향후 계획
- **기획안**: 배경, 목표, 실행 방안
- **백서**: 현황 분석, 제안, 로드맵

---

## 활성화 키워드

사용자가 다음과 같은 요청을 하면 이 스킬이 활성화됩니다:

- "PPT 만들어줘"
- "프레젠테이션 생성"
- "슬라이드 만들기"
- "제안서 PPT"
- "결과보고서 만들기"

---

## 에러 처리

### ANTHROPIC_API_KEY 미설정

```
⚠️ ANTHROPIC_API_KEY 환경변수가 설정되지 않았습니다.

다음 명령어로 설정해주세요:

export ANTHROPIC_API_KEY="sk-ant-..."
```

### 템플릿 파일 없음

```
⚠️ 템플릿 파일(tem.pptx)을 찾을 수 없습니다.

다음 중 하나를 수행해주세요:
1. tem.pptx 파일을 현재 디렉토리에 추가
2. 다른 템플릿 파일 경로 지정
```

### 글자수 초과

```
⚠️ 일부 슬라이드가 글자수 제한을 초과했습니다.

수동으로 slides_data_generated.json을 편집하여
글자수를 조정한 후 다음 명령어를 실행하세요:

python ppt_generator.py slides_data_generated.json output.pptx tem.pptx
```

---

## 고급 사용법

### 수동 조정 워크플로우

1. pipeline.py 실행으로 slides_data_generated.json 생성
2. JSON 파일을 텍스트 에디터로 열어 수동 편집
3. ppt_generator.py로 최종 PPTX 생성

```bash
# 1단계: JSON 생성
python pipeline.py '콘텐츠' output.pptx

# 2단계: JSON 편집 (텍스트 에디터)
# slides_data_generated.json 파일 수정

# 3단계: PPTX 재생성
python ppt_generator.py slides_data_generated.json output_edited.pptx tem.pptx
```

### 템플릿 커스터마이징

템플릿 분석:
```
"템플릿 분석: tem.pptx"
```

커스텀 템플릿 사용:
```bash
python pipeline.py '콘텐츠' output.pptx custom_template.pptx
```

---

## 관련 파일

| 파일 | 역할 |
|------|------|
| [pipeline.py](../../pipeline.py) | 메인 진입점 (오케스트레이터) |
| [generator.py](../../generator.py) | Claude API 콘텐츠 생성 |
| [ppt_generator.py](../../ppt_generator.py) | 템플릿 기반 PPTX 생성 |
| [learning_data/patterns.json](../../learning_data/patterns.json) | 참조 패턴 데이터 |
| tem.pptx | 기본 템플릿 파일 |

---

## 예시

### 예시 1: 제안서 생성

**입력:**
```
H-온드림 2026년 제안서

[발견]
- Born-AI 세대 창업팀 발굴
- 대학생 중심 해커톤 운영

[채용]
- 선발 팀 액셀러레이팅
- 멘토링 및 교육 프로그램

[집중]
- 데모데이 개최
- 투자 연계 지원
```

**출력:**
- 총 7개 슬라이드 (커버 + 각 섹션 2개씩)
- Chapter: "01. 발견", "02. 채용", "03. 집중"
- Title: 각 항목에 맞춘 10-20자 제목
- Lead: 25-35자로 핵심 메시지 전달

### 예시 2: 결과보고서 생성

**입력:**
```
2025년 소셜벤처 액셀러레이팅 결과보고서

[추진 경과]
- 총 15개 팀 선발
- 6개월 프로그램 운영

[주요 성과]
- 투자 유치 총 50억원
- 고용 창출 120명

[향후 계획]
- 2026년 확대 운영
- 신규 분야 확장
```

**출력:**
- 총 9개 슬라이드
- 결과보고서 스타일 적용
- 수치 정보 강조
